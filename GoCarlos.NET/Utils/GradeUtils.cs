using System;

namespace GoCarlos.NET.Utils;

public static class GradeUtils
{
    public static int GetRating(string grade)
    {
        return grade switch
        {
            "9d" => 2900,
            "8d" => 2800,
            "7d" => 2700,
            "6d" => 2600,
            "5d" => 2500,
            "4d" => 2400,
            "3d" => 2300,
            "2d" => 2200,
            "1d" => 2100,
            "1k" => 2000,
            "2k" => 1900,
            "3k" => 1800,
            "4k" => 1700,
            "5k" => 1600,
            "6k" => 1500,
            "7k" => 1400,
            "8k" => 1300,
            "9k" => 1200,
            "10k" => 1100,
            "11k" => 1000,
            "12k" => 900,
            "13k" => 800,
            "14k" => 700,
            "15k" => 600,
            "16k" => 500,
            "17k" => 400,
            "18k" => 300,
            "19k" => 200,
            "20k" => 100,
            "21k" => 0,
            "22k" => -100,
            "23k" => -200,
            "24k" => -300,
            "25k" => -400,
            "26k" => -500,
            "27k" => -600,
            "28k" => -700,
            "29k" => -800,
            "30k" => -900,
            _ => -900
        };
    }

    public static string GetGradeFromRating(int rating)
    {
        return rating switch
        {
            < -850 => "30k",
            < -750 => "29k",
            < -650 => "28k",
            < -550 => "27k",
            < -450 => "26k",
            < -350 => "25k",
            < -250 => "24k",
            < -150 => "23k",
            < -50  => "22k",
            <  50  => "21k",
            <  150 => "20k",
            <  250 => "19k",
            <  350 => "18k",
            <  450 => "17k",
            <  550 => "16k",
            <  650 => "15k",
            <  750 => "14k",
            <  850 => "13k",
            <  950 => "12k",
            < 1050 => "11k",
            < 1150 => "10k",
            < 1250 => "9k",
            < 1350 => "8k",
            < 1450 => "7k",
            < 1550 => "6k",
            < 1650 => "5k",
            < 1750 => "4k",
            < 1850 => "3k",
            < 1950 => "2k",
            < 2050 => "1k",
            < 2150 => "1d",
            < 2250 => "2d",
            < 2350 => "3d",
            < 2450 => "4d",
            < 2550 => "5d",
            < 2650 => "6d",
            < 2750 => "7d",
            < 2850 => "8d",
              _    => "9d"
        };
    }

    public static int GetGradeNFromRating(int rating)
    {
        return (int)Math.Round((rating + 950) / 100d, MidpointRounding.AwayFromZero);
    }

    public static int GetGradeNFromGrade(string grade)
    {
        return grade switch
        {
            "9d" => 38,
            "8d" => 37,
            "7d" => 36,
            "6d" => 35,
            "5d" => 34,
            "4d" => 33,
            "3d" => 32,
            "2d" => 31,
            "1d" => 30,
            "1k" => 29,
            "2k" => 28,
            "3k" => 27,
            "4k" => 26,
            "5k" => 25,
            "6k" => 24,
            "7k" => 23,
            "8k" => 22,
            "9k" => 21,
            "10k" => 20,
            "11k" => 19,
            "12k" => 18,
            "13k" => 17,
            "14k" => 16,
            "15k" => 15,
            "16k" => 14,
            "17k" => 13,
            "18k" => 12,
            "19k" => 11,
            "20k" => 10,
            "21k" => 9,
            "22k" => 8,
            "23k" => 7,
            "24k" => 6,
            "25k" => 5,
            "26k" => 4,
            "27k" => 3,
            "28k" => 2,
            "29k" => 1,
            "30k" => 0,
            _ => 0
        };
    }
}
